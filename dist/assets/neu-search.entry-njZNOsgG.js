import{h as n,F as x,H as E,g as A,r as D,c as f}from"./index-jm4XIquF.js";import{b as u,c as F,e as y,u as C}from"./utilities-a180c6fa-DAHwV70L.js";import{a as B,b as q}from"./functionals-0e75fd99-B0XqP2ve.js";/*!
 * (C) HCA Healthcare Inc. http://hcahealthcare.com - MIT License
 */var S=function(i){return i.field,i.tag,i.id,n("div",{role:"presentation",class:"unit-header"},n("slot",null))},T=function(i){var e=i.onClickEvent,t=function(o){e&&e(o)};return n("button",{type:"button",role:"option",class:"unit-more",tabindex:-1,onClick:function(o){return t(o)}},n("div",{class:"button-text"},n("slot",null)),n("div",{class:"button-icon"},n("neu-icon",null,"arrow_forward")))},P=function(){function i(e){D(this,e),this.neuForm=f(this,"neuForm"),this.neuChange=f(this,"neuChange"),this.neuFocus=f(this,"neuFocus"),this.neuBlur=f(this,"neuBlur"),this.neuClick=f(this,"neuClick"),e.$hostElement$["s-ei"]?this.internals=e.$hostElement$["s-ei"]:(this.internals=e.$hostElement$.attachInternals(),e.$hostElement$["s-ei"]=this.internals),this._tag="neu-form",this._field="neu-search",this._id=C("search"),this._placeholder="Search",this._previousItems=[],this._dropdownOpen=!1,this._focusIndex=0,this.autocomplete="off",this.disabled=!1,this.invalid=void 0,this.label=void 0,this.labelHidden=!0,this.name=void 0,this.pattern=void 0,this.readonly=!1,this.required=void 0,this.tip=void 0,this.unit="search",this.color="blue",this.value=void 0,this.dropdown=!1,this.debounce=0,this.minchar=3,this.error=!1}return i.prototype.handleOnInput=function(e){var t;this.value=e.target?e.target.value:null,this.value&&this.value.length>=Number(this.minchar)&&u(this.dropdown)===!0&&(this._dropdownOpen=!0),this.neuForm.emit({component:this._field,id:e.target.id,name:e.target.name,value:this.value}),this.neuChange.emit({component:this._field,id:e.target.id,name:e.target.name,value:this.value});try{var o=this.value!==void 0?this.value:null;(t=this.internals)===null||t===void 0||t.setFormValue(o)}catch{}},i.prototype.handleOnKeyDown=function(e){var t=this;if(e.key==="ArrowDown"&&this._dropdownOpen===!0)var o=setTimeout(function(){var r=Array.from(t.el.querySelectorAll(".dropdown-menu a, .dropdown-menu button"));r.length>0&&(t._focusIndex=0,r[t._focusIndex].tabIndex=0,r[t._focusIndex].focus({focusVisible:!1})),clearTimeout(o)},50);else e.key==="Tab"&&this.closeDropdownOnBlur()},i.prototype.handleOnFocusBlur=function(e){e==="focus"?(u(this.dropdown)===!0&&this.value&&this.value.length>=Number(this.minchar)&&(this._dropdownOpen=!0),this.neuFocus.emit({component:this._field,id:this._id})):this.neuBlur.emit({component:this._field,id:this._id})},i.prototype.handleOnClick=function(e){this.neuClick.emit({component:this._field,more:!0})},i.prototype.updateDropdownAria=function(){var e=this;if(u(this.dropdown)===!0&&this._dropdownOpen===!0)var t=setTimeout(function(){var o=e.el.querySelector(".dropdown-menu"),r=o==null?void 0:o.querySelectorAll("a, .unit-more");r&&r.forEach(function(s,l){s.hasAttribute("role")||(s.setAttribute("role","option"),s.setAttribute("tabindex","-1"))}),clearTimeout(t)},50);return!0},i.prototype.setAriaRole=function(){return this.unit==="search"?"searchbox":this.unit==="header"?"presentation":void 0},i.prototype.dropdownOpen=function(e){e===!0&&(this.updateDropdownAria(),this.dropdownPosition())},i.prototype.dropdownPosition=function(){var e=document.getElementById(this._id),t=document.getElementById("".concat(this._id,"-dropdown"));e&&t&&F(e,t,"bottom-start",["top-start","bottom-end","top-end"],10,[0,4])},i.prototype.dropdownClickOutside=function(e){this.el.contains(e.target)||(this._dropdownOpen=!1)},i.prototype.dropdownKeyDown=function(e){var t=this,o,r,s,l,b,m,w;if(this._dropdownOpen===!0){var a=e.target,c=((r=(o=a==null?void 0:a.parentElement)===null||o===void 0?void 0:o.dataset)===null||r===void 0?void 0:r.id)||void 0;if(c===void 0){var p=(s=a==null?void 0:a.parentElement)===null||s===void 0?void 0:s.querySelector(".dropdown-menu");p&&(c=(l=p==null?void 0:p.dataset)===null||l===void 0?void 0:l.id);var v=(b=a==null?void 0:a.parentElement)===null||b===void 0?void 0:b.parentElement;v&&(c=(m=v==null?void 0:v.dataset)===null||m===void 0?void 0:m.id)}var d=Array.from((w=this.el)===null||w===void 0?void 0:w.querySelectorAll(".dropdown-menu a, .dropdown-menu button")),g=d.length!==this._previousItems.length||d.some(function(k,I){return k!==t._previousItems[I]});g&&(this._focusIndex=d==null?void 0:d.indexOf(a),this._previousItems=d);var _=this._focusIndex;if(a&&c&&c!==void 0){if((a.id===this._id||c===this._id)&&e.key==="Escape")if(e.preventDefault(),this._dropdownOpen){this.closeDropdownOnBlur();var h=this.el.querySelector("input[type='search']");h&&h.focus({focusVisible:!1})}else this.value="";else if(a.id===this._id||c===this._id){if(e.key==="ArrowDown"?this._focusIndex=(this._focusIndex+1)%d.length:e.key==="ArrowUp"&&(this._focusIndex=(this._focusIndex-1+d.length)%d.length),e.key==="ArrowDown"||e.key==="ArrowUp"){e.preventDefault();var O=setTimeout(function(){d[t._focusIndex]&&(d[t._focusIndex].tabIndex=0,d[t._focusIndex].focus({focusVisible:!1})),d[_]&&(d[_].tabIndex=-1),clearTimeout(O)},50)}if(["ArrowUp","ArrowDown","Escape","Enter","Tab"].includes(e.key))e.key==="Tab"&&this.closeDropdownOnBlur();else{var h=this.el.querySelector("input[type='search']");h&&h.focus({focusVisible:!1})}}}}},i.prototype.closeDropdownOnBlur=function(){var e=this,t=setTimeout(function(){var o,r,s=document==null?void 0:document.activeElement,l=!0;(((o=s==null?void 0:s.parentElement)===null||o===void 0?void 0:o.classList.contains("dropdown-menu"))===!0||!((r=s==null?void 0:s.parentElement)===null||r===void 0)&&r.hasAttribute("unit")&&(s==null?void 0:s.parentElement.getAttribute("unit"))==="more")&&(l=!1),l===!0&&(e._dropdownOpen=!1),clearTimeout(t)},15);return!0},i.prototype.render=function(){var e,t=this,o=(e={},e["".concat(this._tag)]=this.unit==="search",e["".concat(this._field)]=this.unit==="search",e["unit-".concat(this.unit)]=this.unit!=="search",e["color-".concat(this.color)]=this.unit==="search",e["state-disabled"]=this.unit==="search"&&u(this.disabled)===!0,e["state-active"]=this.unit==="search"&&this._dropdownOpen===!0,e["state-optional"]=u(this.required)===!1,e["state-error"]=u(this.error)===!0,e);return n(E,{key:"49ddc9f2ca672cb6340958da4f401f9f02b1b5d1","aria-labelledby":this.unit==="search"?"".concat(this._id,"-label"):void 0,class:this.unit==="search"?o:void 0,role:this.setAriaRole()},this.unit==="search"&&n(x,{key:"ee8e10d7be8e9b65796aa76e38576841d37c3b7d"},n(B,{key:"6c2ba8bcfa6f73e25b782b306f7b13ca1981f721",id:this._id,tag:this._tag,label:this.label===void 0?this._id+"-label":this.label,labelHidden:u(this.labelHidden),required:u(this.required)}),n("div",{key:"b264081efb48f4a98d550c7dfac19fd894bcde62",class:"unit-wrapper"},n("input",{key:"e9fa0d05cffae5fc8e40ba613f20a6abea7b86dc","aria-describedby":this.tip!==void 0||this.invalid!=="undefined"?"".concat(this._id,"-support"):void 0,"aria-expanded":this._dropdownOpen===!0?"true":"false","aria-controls":"".concat(this._id,"-dropdown"),"aria-labelledby":"".concat(this._id,"-label"),class:"".concat(this._tag,"__native"),disabled:u(this.disabled)===!0?!0:void 0,id:this._id,name:this._id,placeholder:this._placeholder,type:"search",value:this.value,role:u(this.dropdown)===!0?"combobox":"search",onInput:y(function(r){return t.handleOnInput(r)}),onKeyDown:y(function(r){return t.handleOnKeyDown(r)}),onFocus:function(){return t.handleOnFocusBlur("focus")},onBlur:function(){return t.handleOnFocusBlur("blur")}}),u(this.dropdown)===!0?n("div",{class:"unit-dropdown",id:"".concat(this._id,"-dropdown")},n("div",{class:"dropdown-menu","data-id":this._id,role:"listbox",tabindex:0,"aria-expanded":this._dropdownOpen===!0?"true":"false","aria-labelledby":"".concat(this._id,"-label")},n("slot",null))):n("div",{class:"d-none"},n("slot",null)),u(this.dropdown)===!0&&n("div",{key:"e6cc20cfdf7c20274f50f9107ee42eceab722c6f","aria-live":"polite",class:"sr-only"},this._dropdownOpen&&"A menu with potential search results opened. Down arrow to review.")),n(q,{key:"b7320344efae656181b9484a0abc672e2e17a0c0",tag:this._tag,id:this._id,tip:this.tip,invalid:this.invalid})),this.unit==="header"&&n(S,{key:"69154967585d5d70af88d9b344d248d747071640",tag:this._tag,field:this._field,id:this._id},n("slot",{key:"9234380fcd1c62118b3c10184250f5c1d7d20064"})),this.unit==="more"&&n(T,{key:"5e092619ba0ca227f9fccf4b4a8e434ecebdd91b",onClickEvent:function(r){t.handleOnClick(r)}},n("slot",{key:"74c8b65fec1a878693e0e4e0be4b2007cfced080"})))},i.prototype.componentDidLoad=function(){this.el.addEventListener("keydown",this.dropdownKeyDown.bind(this))},i.prototype.disconnectedCallback=function(){this.el.removeEventListener("keydown",this.dropdownKeyDown.bind(this))},Object.defineProperty(i,"formAssociated",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"el",{get:function(){return A(this)},enumerable:!1,configurable:!0}),Object.defineProperty(i,"watchers",{get:function(){return{_dropdownOpen:["dropdownOpen"]}},enumerable:!1,configurable:!0}),i}();export{P as neu_search};
